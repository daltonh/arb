MARKDOWN
Here we add the suffix of <<suffix>> (defaults to _/species/) to every variable involved in the navier-stokes equations, making them specific to one phase (for example)
Also accepts an <<action>>=cancel option which cancels these replacements
END_MARKDOWN

{{ print "BEFORE: navier_stokes_replacements:\n".string_debug; }}

{{ string_set("<<action>>","replace","default,noreplace");
   string_set("<<suffix>>","_/species/","default,noreplace"); }}

{{ print "AFTER DEFAULTS: navier_stokes_replacements:\n".string_debug; }}

{{
# setup list of variables that need the suffix added
  string_set("<<navier_stokes_variables>>",
'<mu> <rho> <u_av> <Re> <u[l=1]> <u[l=2]> <p> <ugrad_f[l=1,1]> <ugrad_f[l=1,2]> <ugrad_f[l=2,1]> <ugrad_f[l=2,2]> <p_f> <dynamic_force_c[l=1]> <dynamic_force_c[l=2]> <p_error> <u_f_{raw}> <u_f_{correction}> <u_f> <J_f[l=1]> <J_f[l=2]> <continuity> <momentum[l=1]> <momentum[l=2]> <outlet fully developed> <outlet no slip1> <outlet flowrate equation> <walls noflux> <walls noslip1> <walls p_extrapolation> <inlet fully developed> <inlet no slip1> <inlet flowrate equation> <tau[l=1,1]> <tau[l=2,2]> <tau[l=1,2]> <tau[l=2,1]> <dynamic_force_f> <u_f_vect[l=1]> <u_f_vect[l=2]> <u_rf_{vis}> <u_rf_{adv}> <J_advection_f[l=1]> <J_advection_f[l=2]>',
# '<u_f> <ugrad_f[l=:,:]> <u[l=:]> <p_f> <p> <rho> <mu> <u_av> <Re>', 
  "default,noreplace");
}}
{{
# loop through the variables (a space separated variable list) either adding suffix replacement string, or removing this string
  foreach my $i ( string_eval("<<navier_stokes_variables>>","variablelist") ) {
    if (string_test("<<action>>","replace")) {
      string_set($i,string_eval("<<suffix>>"),"suffix,global"); # the suffix option
    } else {
      string_delete($i,"suffix,global");
    }
  }
}}


{{ print "AFTER: navier_stokes_replacements:\n".string_debug; }}


#
# '<u_f> <ugrad_f[l=:,:]> <u[l=:]> <p_f> <p> <rho> <mu> <u_av> <Re>', 
