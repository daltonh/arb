MARKDOWN
Here we find <beta*_<<species>>_species0> and <beta*_species0_<<species>>> for combinations of species in which one of them is the continuous phase (species0)
END_MARKDOWN

#OVERRIDE_OPTIONS output
IF {{ return string_test('<<species>>','species0') }}
  ERROR "single_species_drag can only be called with disperse phase species: was called with species = <<species>>"
END_IF

REPLACEMENTS D "<<RichardsonZakiDrag>>" W "0"
REPLACEMENTS D "<<RichardsonZakiDragfluidbased>>" W "0"

# calculate kappa*, which only has one value for each combination of species, define with the lower index coming first
#Stokes drag
CELL_DERIVED <kappa*_species0_<<species>>> "2.d0*<a_<<species>>>^2/9.d0" ON <allcells> 
IF <<RichardsonZakiDrag>> # R-Z, Pe < O(10^8)
  IF <<RichardsonZakiDragfluidbased>>
# currently there is only drag between each species and the fluid
# basing the hindered settling function on the fluid volume fraction will partly capture the drag between solid species at high total solids volume fractions
    VARIABLE <kappa*_species0_<<species>>> "<kappa*_species0_<<species>>>*(<phi_pos_species0>)**5.5" ON <allcells>	
  ELSE
    VARIABLE <kappa*_species0_<<species>>> "<kappa*_species0_<<species>>>*(1.-<phi_pos_<<species>>>)**5.5" ON <allcells>	
  END_IF
END_IF

#REPLACEMENTS R "bounded" W "pos"
CELL_DERIVED <beta**_species0_<<species>>> "<mu_species0>*<phi_bounded_species0>/<kappa*_species0_<<species>>>" ON <allcells>
CELL_LOCAL <beta**_<<species>>_species0> "<beta**_species0_<<species>>>" ON <allcells>
CELL_DERIVED <beta*i_species0_<<species>>> "<beta**_species0_<<species>>>*<phi_bounded_species0>" ON <allcells>
CELL_LOCAL <beta*j_<<species>>_species0> "<beta*i_species0_<<species>>>" ON <allcells>
CELL_DERIVED <beta*j_species0_<<species>>> "<beta**_species0_<<species>>>*<phi_bounded_<<species>>>" ON <allcells>
CELL_LOCAL <beta*i_<<species>>_species0> "<beta*j_species0_<<species>>>" ON <allcells>
CELL_DERIVED <beta_species0_<<species>>> "<beta*i_species0_<<species>>>*<phi_bounded_<<species>>>" ON <allcells>
CELL_LOCAL <beta_<<species>>_species0> "<beta_species0_<<species>>>" ON <allcells>

IF 0
  FACE_DERIVED <beta*i_f_<<species>>_species0> "faceave(<beta*i_<<species>>_species0>)" ON <allfaces>
  FACE_LOCAL <beta*j_f_species0_<<species>>> "<beta*i_f_<<species>>_species0>" ON <allfaces>
  FACE_DERIVED <beta*i_f_species0_<<species>>> "faceave(<beta*i_species0_<<species>>>)" ON <allfaces>
  FACE_LOCAL <beta*j_f_<<species>>_species0> "<beta*i_f_species0_<<species>>>" ON <allfaces>
ELSE
  FACE_DERIVED <beta*i_f_<<species>>_species0> "faceave[adjacentcells](<beta*i_<<species>>_species0>)" ON <allfaces>
  FACE_LOCAL <beta*j_f_species0_<<species>>> "<beta*i_f_<<species>>_species0>" ON <allfaces>
  FACE_DERIVED <beta*i_f_species0_<<species>>> "faceave[adjacentcells](<beta*i_species0_<<species>>>)" ON <allfaces>
  FACE_LOCAL <beta*j_f_<<species>>_species0> "<beta*i_f_species0_<<species>>>" ON <allfaces>
END_IF
#OVERRIDE_OPTIONS
