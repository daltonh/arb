<pre >
<span style="color: #87D7D7;"># arb finite volume solver</span>
<span style="color: #87D7D7;"># Copyright 2009,2010 Dalton Harvie (daltonh@unimelb.edu.au)</span>
<span style="color: #87D7D7;">#</span>
<span style="color: #87D7D7;"># arb is released under the GNU GPL.  For full details see the license directory.</span>
<span style="color: #87D7D7;">#</span>
<span style="color: #87D7D7;">#-------------------------------------------------------------------</span>
<span style="color: #875FFF; font-weight: bold;">VERSION</span> <span style="color: #FFAF00;">0.53</span> <span style="color: #87D7D7;"># the version of syntax used in this file</span>

<span style="color: #87D7D7;"># the following strings describe the simulation and are passed to the output files</span>
<span style="color: #875FFF; font-weight: bold;">INFO_TITLE</span> <span style="color: #5F5F87;">&quot;Steady state flow around an offset cylinder within a channel&quot;</span>
<span style="color: #875FFF; font-weight: bold;">INFO_DESCRIPTION</span> <span style="color: #5F5F87;">&quot;Tutorial 3: Here the steady-state Navier-Stokes equations are solved in 2D, using an unstructured mesh.  The Reynolds number for the problem based on the cylinder diameter and maximum inlet velocity is 20.  This is a CFD benchmark problem.  The problem is not physical however, as the inlet has an imposed parabolic profile but is also very close to the cylinder.&quot;</span>
<span style="color: #875FFF; font-weight: bold;">INFO_AUTHOR</span> <span style="color: #5F5F87;">&quot;Dalton Harvie&quot;</span>
<span style="color: #875FFF; font-weight: bold;">INFO_DATE</span> <span style="color: #5F5F87;">&quot;14/5/14&quot;</span> <span style="color: #87D7D7;"># interpreted as the last modification date</span>

<span style="color: #87D7D7;">#-------------------------------------------------------------------</span>
<span style="color: #87D7D7;"># system constants</span>

<span style="color: #87D7D7;">#KERNEL_OPTIONS polynomialorder=3 # setting order of kernel function for face derivatives</span>
<span style="color: #87D7D7;">#KERNEL_OPTIONS checkminw=.true.,minimumminw=0.8d0 # reducing the minw a bit which will decrease the size of the kernels</span>

<span style="color: #87D7D7;">#-------------------------------------------------------------------</span>
<span style="color: #87D7D7;"># geometry</span>

<span style="color: #87D7D7;"># CELL_REGION/FACE_REGION specified by: &lt;name&gt; &quot;location string&quot; # comments</span>
<span style="color: #87D7D7;"># where location string could be: &quot;at(x1,x2,x3)&quot; for a single point closest to these coordinates</span>
<span style="color: #87D7D7;"># where location string could be: &quot;withinbox(x1_min,x2_min,x3_min,x1_max,x2_max,x3_max)&quot; for all elements within a box defined by the minimum and maximum coordinate values</span>
<span style="color: #87D7D7;"># where location string could be: &quot;compound(+&lt;a region&gt;-&lt;another region&gt;)&quot; for a + and - compound region list</span>
<span style="color: #87D7D7;"># where location string could be: &quot;boundaryof(&lt;a region&gt;)&quot; - boundary faces/cells contained within or surrounding &lt;a region&gt;</span>
<span style="color: #87D7D7;"># where location string could be: &quot;domainof(&lt;a region&gt;)&quot; - domain faces/cells contained within &lt;a region&gt;</span>
<span style="color: #87D7D7;"># where location string could be: &quot;associatedwith( &lt;a region&gt;)&quot; - faces/cells both contained within and surrounding &lt;a region&gt;</span>

<span style="color: #875FFF; font-weight: bold;">FACE_REGION</span> <span style="color: #808080;">&lt;walls&gt;</span> <span style="color: #808080;">&quot;compound(</span><span style="color: #8700D7;">&lt;boundaries&gt;</span><span style="color: #875FFF; font-weight: bold;">-</span><span style="color: #808080;">&lt;inlet&gt;</span><span style="color: #875FFF; font-weight: bold;">-</span><span style="color: #808080;">&lt;outlet&gt;</span><span style="color: #808080;">)&quot;</span>

<span style="color: #87D7D7;"># MSH_FILE instructs arb to read or write a gmsh file (location is read location - write location will always be within the output directory)</span>
<span style="color: #87D7D7;"># output options are: output,centringoutput,meshoutput,centringmeshoutput,nooutput</span>
<span style="color: #87D7D7;"># input options are: input,centringinput,meshinput,centringmeshinput,noinput</span>
<span style="color: #87D7D7;"># data output format options for CELL centred data (which overwrite individual variable options if specified): elementdata,elementnodedata,elementnodelimiteddata</span>
<span style="color: #87D7D7;"># vtk file output options are: vtkoutput,centringvtkoutput,meshvtkoutput,centringmeshvtkoutput,novtkoutput (novtkoutput is the default)</span>
<span style="color: #87D7D7;"># dat file output options are: datoutput,centringdatoutput,meshdatoutput,centringmeshdatoutput,nodatoutput (nodatoutput is the default)</span>
<span style="color: #875FFF; font-weight: bold;">MSH_FILE</span> <span style="color: #5F5F87;">&quot;steady_state_channel_flow_with_cylinder.msh&quot;</span>
<span style="color: #875FFF; font-weight: bold;">MSH_FILE</span> <span style="color: #5F5F87;">&quot;output/output.msh&quot;</span> <span style="color: #008787; font-weight: bold;">centringvtkoutput</span><span style="color: #808080;">,</span><span style="color: #008787; font-weight: bold;">datoutput</span>

<span style="color: #87D7D7;">#-------------------------------------------------------------------</span>
<span style="color: #87D7D7;"># variable definition reference:</span>
<span style="color: #87D7D7;"># REGION_LIST &lt;region_1&gt; &lt;region_2&gt; ... &lt;region_n&gt; # comments: line has the ordered names of any regions</span>
<span style="color: #87D7D7;"># (CELL_|FACE_)REGION_CONSTANT &lt;name&gt; [multiplier*units] numerical_value_for_region_1 .. value_for_region_n options # comments: sets a constant that varies with region</span>
<span style="color: #87D7D7;"># (CELL_|FACE_|NONE_|)CONSTANT &lt;name&gt; [multiplier*units] numerical_value ON &lt;region&gt; options # comments: sets a constant specific to one region or no regions and has the form</span>
<span style="color: #87D7D7;"># (CELL_|FACE_|NONE|)CONSTANT &lt;name&gt; [units] &quot;expression (involving only constants)&quot; ON &lt;region&gt; options # comments</span>
<span style="color: #87D7D7;"># (CELL_|FACE_|NONE|)TRANSIENT &lt;name&gt; [units] &quot;expression (initial value, optional, evaluated in descending relstep order)&quot; &quot;expression (evaluated in ascending relstep order)&quot; ON &lt;region&gt; options # comments</span>
<span style="color: #87D7D7;"># (CELL_|FACE_|NONE|)NEWTIENT &lt;name&gt; [units] &quot;expression (initial value, optional, evaluated in descending relstep order)&quot; &quot;expression (evaluated in ascending relstep order)&quot; ON &lt;region&gt; options # comments</span>
<span style="color: #87D7D7;"># (CELL_|FACE_|NONE|)DERIVED &lt;name&gt; [units] &quot;expression&quot; ON &lt;region&gt; options # comments</span>
<span style="color: #87D7D7;"># (CELL_|FACE_|NONE|)UNKNOWN &lt;name&gt; [units] &quot;expression (initial value, optional)&quot; ON &lt;region&gt; options # comments</span>
<span style="color: #87D7D7;"># (CELL_|FACE_|NONE|)EQUATION &lt;name&gt; [units] &quot;expression (equation equaling zero)&quot; ON &lt;region&gt; options # comments</span>
<span style="color: #87D7D7;"># (CELL_|FACE_|NONE|)OUTPUT &lt;name&gt; [units] &quot;expression&quot; ON &lt;region&gt; options # comments</span>
<span style="color: #87D7D7;"># (CELL_|FACE_|NONE|)CONDITION &lt;name&gt; [units] &quot;expression&quot; ON &lt;region&gt; options # comments</span>
<span style="color: #87D7D7;"># (CELL_|FACE_|NONE|)LOCAL &lt;name&gt; [units] &quot;expression&quot; ON &lt;region&gt; options # comments</span>

<span style="color: #87D7D7;"># options include (with p=perl and f=fortran indicating which piece of code needs to know the option):</span>
<span style="color: #87D7D7;">#p  derivative/noderivative - for DERIVED, EQUATION, LOCAL : do or do not calculate Jacobian derivatives for this variable</span>
<span style="color: #87D7D7;">#p  positive/negative/nocheck - for DERIVED, UNKNOWN, EQUATION, LOCAL : check at each iteration that variable is positive/negative</span>
<span style="color: #87D7D7;">#f  output/nooutput - for ALL : output compound to msh files</span>
<span style="color: #87D7D7;">#f  componentoutput/nocomponentoutput - for ALL : output just this component to msh files</span>
<span style="color: #87D7D7;">#f  stepoutput/stepoutputnoupdate/nostepoutput - for ALL : output compound to step file.  The noupdate one does not update the variable when the step file is written (needed for recording when output occurred for example).</span>
<span style="color: #87D7D7;">#f  componentstepoutput/componentstepoutputnoupdate/nocomponentstepoutput - for ALL : output just this component to step files</span>
<span style="color: #87D7D7;">#f  input/noinput - for CONSTANT, TRANSIENT, UNKNOWN : read in compound from msh files - only these 3 variable types can be read in</span>
<span style="color: #87D7D7;">#f  componentinput/nocomponentinput - for CONSTANT, TRANSIENT, UNKNOWN : read in just this component from msh files - only these 3 variable types can be read in</span>
<span style="color: #87D7D7;">#f  elementdata,elementnodedata,elementnodelimiteddata - for CELL centred var : data type when writing this compound (unless gmesh overide is specified) (also same for components with prefix component)</span>
<span style="color: #87D7D7;">#p  outputcondition,stopcondition,convergencecondition,bellcondition - for CONDITION, type of condition, can have multiple conditions for the one variable</span>
<span style="color: #87D7D7;">#f  magnitude=value - for EQUATION, UNKNOWN specifies the initial variable magnitude to be used (rather than being based on the initial variable values) - a negative number will cause the magnitude to be set based upon the initial values (which is the default)</span>
<span style="color: #87D7D7;">#f  dynamicmagnitude/staticmagnitude - for EQUATION, UNKNOWN, adjust magnitude of variable dynamically as the simulation progresses, or keep it constant at the initial magnitude</span>
<span style="color: #87D7D7;">#f  dynamicmagnitudemultiplier=value - for EQUATION, UNKNOWN, multiplier to use when adjusting magnitude of variable dynamically (=&gt;1.d0, with 1.d0 equivalent to static magnitudes, and large values placing no restriction on the change in magnitude from one newton iteration to the next)</span>
<span style="color: #87D7D7;">#   clearoptions - remove all previously (to the left and above the clearoptions word) user-specified options for this variable</span>

<span style="color: #875FFF; font-weight: bold;">GENERAL_REPLACEMENTS</span> <span style="color: #875FFF; font-weight: bold;">REPLACE</span> <span style="color: #5F5F87;">&quot;&lt;&lt;dim3comment&gt;&gt;&quot;</span> <span style="color: #875FFF; font-weight: bold;">WITH</span> <span style="color: #5F5F87;">&quot;#&quot;</span> <span style="color: #87D7D7;"># comment out any references to the third dimension in any included files</span>

<span style="color: #87D7D7;"># variables etc</span>

<span style="color: #87D7D7;"># use templates from the navier_stokes directory to build up problem</span>
<span style="color: #875FFF; font-weight: bold;">INCLUDE_ROOT</span> <span style="color: #5F5F87;">&quot;navier_stokes&quot;</span> <span style="color: #87D7D7;"># this is the base directory that will be appended to the following files</span>
<span style="color: #875FFF; font-weight: bold;">INCLUDE</span> <span style="color: #5F5F87;">&quot;constants&quot;</span> <span style="color: #87D7D7;"># specify physical and numerical constants</span>
<span style="color: #875FFF; font-weight: bold;">INCLUDE</span> <span style="color: #5F5F87;">&quot;domain&quot;</span> <span style="color: #87D7D7;"># equations to be solved within the domain</span>
<span style="color: #875FFF; font-weight: bold;">INCLUDE</span> <span style="color: #5F5F87;">&quot;outlet_p_set&quot;</span> <span style="color: #87D7D7;"># outlet BC</span>
<span style="color: #875FFF; font-weight: bold;">INCLUDE</span> <span style="color: #5F5F87;">&quot;walls&quot;</span> <span style="color: #87D7D7;"># nonslip walls BC</span>

<span style="color: #87D7D7;"># inlet BCs have to be special cased a bit</span>
<span style="color: #87D7D7;">#INCLUDE &quot;inlet_u_fully_developed&quot; # fully developed velocity profile, setting a uniform pressure to give using &lt;u_av&gt;</span>
<span style="color: #875FFF; font-weight: bold;">INCLUDE</span> <span style="color: #5F5F87;">&quot;inlet_u_set&quot;</span> <span style="color: #87D7D7;"># velocity profile set as uniform &lt;u_av&gt;</span>
<span style="color: #87D7D7;"># overwritting the uniform profile with the parabolic one from the test problem</span>
<span style="color: #875FFF; font-weight: bold;">FACE_EQUATION</span> <span style="color: #808080;">&lt;inlet flowrate equation&gt;</span> <span style="color: #808080;">&quot;</span><span style="color: #808080;">&lt;u_f&gt;</span><span style="color: #875FFF; font-weight: bold;">+</span><span style="color: #FFAF00;">6.d0</span><span style="color: #875FFF; font-weight: bold;">*</span><span style="color: #808080;">&lt;u_av&gt;</span><span style="color: #875FFF; font-weight: bold;">*</span><span style="color: #8700D7;">&lt;cellx[l=2]&gt;</span><span style="color: #875FFF; font-weight: bold;">*</span><span style="color: #808080;">(</span><span style="color: #FFAF00;">0.41d0</span><span style="color: #875FFF; font-weight: bold;">-</span><span style="color: #8700D7;">&lt;cellx[l=2]&gt;</span><span style="color: #808080;">)</span><span style="color: #875FFF; font-weight: bold;">/</span><span style="color: #808080;">(</span><span style="color: #FFAF00;">0.41d0</span><span style="color: #875FFF; font-weight: bold;">^</span><span style="color: #FFAF00;">2</span><span style="color: #808080;">)&quot;</span> <span style="color: #875FFF; font-weight: bold;">ON</span> <span style="color: #808080;">&lt;inlet&gt;</span>

<span style="color: #87D7D7;"># overwrite previous properties with the following</span>
<span style="color: #875FFF; font-weight: bold;">CONSTANT</span> <span style="color: #808080;">&lt;mu&gt;</span> <span style="color: #5F5F87;">[Pa.s]</span> <span style="color: #FFAF00;">1.d-3</span> <span style="color: #87D7D7;"># viscosity of liquid</span>
<span style="color: #875FFF; font-weight: bold;">CONSTANT</span> <span style="color: #808080;">&lt;rho&gt;</span> <span style="color: #5F5F87;">[kg/m^3]</span> <span style="color: #FFAF00;">1.d0</span> <span style="color: #87D7D7;"># density</span>
<span style="color: #875FFF; font-weight: bold;">CONSTANT</span> <span style="color: #808080;">&lt;u_av&gt;</span> <span style="color: #5F5F87;">[m/s]</span> <span style="color: #FFAF00;">0.2d0</span> <span style="color: #87D7D7;"># average inlet velocity</span>

<span style="color: #87D7D7;"># calculate drag and lift on object</span>
<span style="color: #875FFF; font-weight: bold;">NONE_OUTPUT</span> <span style="color: #808080;">&lt;F_drag&gt;</span> <span style="color: #5F5F87;">[N]</span> <span style="color: #808080;">&quot;</span><span style="color: #5F8787;">facesum</span><span style="color: #808080;">(</span><span style="color: #8700D7;">&lt;facearea&gt;</span><span style="color: #875FFF; font-weight: bold;">*</span><span style="color: #5F8787;">dot</span><span style="color: #808080;">(</span><span style="color: #8700D7;">&lt;facenorm[l=:]&gt;</span><span style="color: #808080;">,</span><span style="color: #808080;">&lt;tau[l=:,1]&gt;</span><span style="color: #808080;">),</span><span style="color: #808080;">&lt;cylinder&gt;</span><span style="color: #808080;">)</span><span style="color: #808080;">&quot;</span> <span style="color: #87D7D7;"># force on object in axial direction</span>
<span style="color: #875FFF; font-weight: bold;">NONE_OUTPUT</span> <span style="color: #808080;">&lt;F_lift&gt;</span> <span style="color: #5F5F87;">[N]</span> <span style="color: #808080;">&quot;</span><span style="color: #5F8787;">facesum</span><span style="color: #808080;">(</span><span style="color: #8700D7;">&lt;facearea&gt;</span><span style="color: #875FFF; font-weight: bold;">*</span><span style="color: #5F8787;">dot</span><span style="color: #808080;">(</span><span style="color: #8700D7;">&lt;facenorm[l=:]&gt;</span><span style="color: #808080;">,</span><span style="color: #808080;">&lt;tau[l=:,2]&gt;</span><span style="color: #808080;">),</span><span style="color: #808080;">&lt;cylinder&gt;</span><span style="color: #808080;">)</span><span style="color: #808080;">&quot;</span> <span style="color: #87D7D7;"># force on object in vertical direction</span>
<span style="color: #875FFF; font-weight: bold;">NONE_OUTPUT</span> <span style="color: #808080;">&lt;C_drag&gt;</span> <span style="color: #808080;">&quot;</span><span style="color: #FFAF00;">2.d0</span><span style="color: #875FFF; font-weight: bold;">*</span><span style="color: #808080;">&lt;F_drag&gt;</span><span style="color: #875FFF; font-weight: bold;">/</span><span style="color: #808080;">(</span><span style="color: #808080;">&lt;rho&gt;</span><span style="color: #875FFF; font-weight: bold;">*</span><span style="color: #808080;">&lt;u_av&gt;</span><span style="color: #875FFF; font-weight: bold;">^</span><span style="color: #FFAF00;">2</span><span style="color: #875FFF; font-weight: bold;">*</span><span style="color: #FFAF00;">0.1d0</span><span style="color: #808080;">)&quot;</span> <span style="color: #87D7D7;"># drag coefficient</span>
<span style="color: #875FFF; font-weight: bold;">NONE_OUTPUT</span> <span style="color: #808080;">&lt;C_lift&gt;</span> <span style="color: #808080;">&quot;</span><span style="color: #FFAF00;">2.d0</span><span style="color: #875FFF; font-weight: bold;">*</span><span style="color: #808080;">&lt;F_lift&gt;</span><span style="color: #875FFF; font-weight: bold;">/</span><span style="color: #808080;">(</span><span style="color: #808080;">&lt;rho&gt;</span><span style="color: #875FFF; font-weight: bold;">*</span><span style="color: #808080;">&lt;u_av&gt;</span><span style="color: #875FFF; font-weight: bold;">^</span><span style="color: #FFAF00;">2</span><span style="color: #875FFF; font-weight: bold;">*</span><span style="color: #FFAF00;">0.1d0</span><span style="color: #808080;">)&quot;</span> <span style="color: #87D7D7;"># lift coefficient</span>

<span style="color: #87D7D7;"># output a flag telling us which term limited the correction velocity</span>
<span style="color: #875FFF; font-weight: bold;">FACE_OUTPUT</span> <span style="color: #808080;">&lt;advection correction limited&gt;</span> <span style="color: #808080;">&quot;</span><span style="color: #5F8787;">faceif</span><span style="color: #808080;">(</span><span style="color: #808080;">&lt;u_mf_{adv}&gt;</span><span style="color: #875FFF; font-weight: bold;">-</span><span style="color: #808080;">&lt;u_mf_{vis}&gt;</span><span style="color: #808080;">,</span><span style="color: #FFAF00;">0.d0</span><span style="color: #808080;">,</span><span style="color: #FFAF00;">1.d0</span><span style="color: #808080;">)</span><span style="color: #808080;">&quot;</span> <span style="color: #875FFF; font-weight: bold;">ON</span> <span style="color: #8700D7;">&lt;domain faces&gt;</span> <span style="color: #87D7D7;"># is 1 where advection component is limiting velocity correction</span>
<span style="color: #87D7D7;"># and turn some outputs on using the generic VARIABLE statement that picks up the last type and centring</span>
<span style="color: #875FFF; font-weight: bold;">VARIABLE</span> <span style="color: #808080;">&lt;u_f_{correction}&gt;</span> <span style="color: #008787; font-weight: bold;">output</span>
<span style="color: #875FFF; font-weight: bold;">VARIABLE</span> <span style="color: #808080;">&lt;u_f_{raw}&gt;</span> <span style="color: #008787; font-weight: bold;">output</span>
<span style="color: #875FFF; font-weight: bold;">VARIABLE</span> <span style="color: #808080;">&lt;u_f&gt;</span> <span style="color: #008787; font-weight: bold;">output</span>
<span style="color: #875FFF; font-weight: bold;">VARIABLE</span> <span style="color: #808080;">&lt;J_f[l=1]&gt;</span> <span style="color: #008787; font-weight: bold;">output</span>
<span style="color: #875FFF; font-weight: bold;">VARIABLE</span> <span style="color: #808080;">&lt;tau[l=1,1]&gt;</span> <span style="color: #008787; font-weight: bold;">output</span>

<span style="color: #87D7D7;">#INCLUDE_ROOT &quot;navier_stokes&quot;</span>
<span style="color: #87D7D7;">#INCLUDE &quot;strain_rate_magnitude&quot;</span>
<span style="color: #87D7D7;">#-------------------------------------------------------------------</span>
</pre>
