MARKDOWN
Boundary conditions on inlet, specifying fully developed flow

There are two choices here for the first equation which determines the relationship between the boundary and just-within domain velocities:
1. the local pressure gradient at the inlet port is related to the inlet velocity via a rhie-chow type calculation (<<pextrapolationports>>=rhiechow) - this isn't the default, as it isn't really what most think fully developed is, or
2. the gradient of the normal velocity normal to the port is zero (<<pextrapolationports>> != rhiechow)
END_MARKDOWN

#REPLACEMENTS D "<<pextrapolationports>>" W "<<pextrapolation>>" # an alternative default that picks up the wall pextrapolation method
REPLACEMENTS D "<<pextrapolationports>>" W "0" # by default 
IF {{ return string_test("<<pextrapolationports>>","rhiechow"); }}
  INCLUDE "p_extrapolation_rhie_chow" REPLACE "<region>" WITH "<inlet>" REPLACE "<equation>" WITH "<inlet fully developed>"
ELSE
  INCLUDE "u_fully_developed" REPLACE "<region>" WITH "<inlet>" REPLACE "<equation>" WITH "<inlet fully developed>"
END_IF

INCLUDE "noslip" REPLACE "<region>" WITH "<inlet>" REPLACE "<equation" WITH "<inlet no slip"

# alternatively, set uniform inlet pressure giving required average velocity
<<cartesiancomment>>NONE_DERIVED <u_av_calc> "facesum(-<u_f>*<facearea>,<inlet>)/facesum(<facearea>,<inlet>)" # calculate average velocity directed into the domain
<<cylindricalcomment>>NONE_DERIVED <u_av_calc> "facesum(-<u_f>*<facearea>*<<radius_f>>,<inlet>)/facesum(<facearea>*<<radius_f>>,<inlet>)" # calculate average velocity directed into the domain

# now reference pressure gradient at centreline directly, removing one unknown and equation, but requiring <inlet sans centreline> and <inlet centreline> (from eg inlet_centreline_region template)
NONE_EQUATION <inlet centreline flowrate equation> "<u_av_calc>-<u_av>" # set flowrate through inlet to give required average velocity
NONE_DERIVED <inlet centreline gradp> "facesum(<dynamic_force_f>,region=<inlet centreline>)"
FACE_EQUATION <inlet flowrate equation> "<dynamic_force_f>-<inlet centreline gradp>" ON <inlet sans centreline> # apply specified pressure over inlet
