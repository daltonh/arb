
REPLACEMENTS D "<<action>>" W "replace"
INFO_TITLE "another thing"

{{
# setup list of variables that need the suffix added
  string_set("<<navier_stokes_variables>>",
  '<u_f> <ugrad_f[l=:,:]> <u[l=:]> <p_f> <p> <rho> <mu> <u_av> <Re>', 
  "global")

# loop through the variables (a space separated variable list) either adding suffix replacement string, or removing this string
  foreach my $i ( string_eval("<<navier_stokes_variables>>","variablelist") ) {
    if (string_test("<<action>>","replace")) {
      string_set($i,"_/species/","suffix,global");
    } else {
      string_delete($i,"suffix,global");
    }
  }
}}




#   R "<u_f>" W "<u_f_/species/>" &
#   R "<ugrad_f[" W "<ugrad_f_/species/[" &
#   R "<u[" W "<u_/species/["  &
#   R "<p_f>" W "<p_f_/species/>" &
#   R "<p>" W "<p_/species/>" &
#   R "<rho>" W "<rho_/species/>" &
#   R "<mu>" W "<mu_/species/>" &
#   R "<u_av>" W "<u_av_/species/>" &
#   R "<Re>" W "<Re_/species/>" &
#   R "<u_av>" W "<u_av_/species/>" &
#   R "<u_av>" W "<u_av_/species/>" &
#   R "<u_av>" W "<u_av_/species/>" &


# CELL_DERIVED <dynamic_force_c[l=1]> [1] "-celldivgrad[l=1](<p_f>)" ON <allcells> # other information: region = <allcells>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/dynamic_force.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/dynamic_force.arb: comments = empty
# CELL_DERIVED <dynamic_force_c[l=2]> [1] "-celldivgrad[l=2](<p_f>)" ON <allcells> # other information: region = <allcells>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/dynamic_force.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/dynamic_force.arb: comments = empty
# FACE_DERIVED <p_error> [1] "faceif(<facereflectnorm>,(-<dynamic_force_f>+faceave[adjacentcells](( + (<dynamic_force_c[l=1]>)*(cellave[lastface](<facedxunit[l=1]>)) + (<dynamic_force_c[l=2]>)*(cellave[lastface](<facedxunit[l=2]>)) + (<dynamic_force_c[l=3]>)*(cellave[lastface](<facedxunit[l=3]>)) )))*<dot_facenorm_facedxunit>,0.d0)" ON <domainfaces> # other information: region = <domainfaces>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/p_error.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/p_error.arb: comments = empty
# FACE_DERIVED <u_f_{raw}> [1] "( + (<u_f_vect[l=1]>)*(<facenorm[l=1]>) + (<u_f_vect[l=2]>)*(<facenorm[l=2]>) + (<u_f_vect[l=3]>)*(<facenorm[l=3]>) )" ON <allfaces> # other information: region = <allfaces>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/u_f.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/u_f.arb: comments = # volume (velocity) transport
# FACE_DERIVED <u_f_{correction}> [1] "-<C_{Rhie-Chow}>*<p_error>/(<u_rf_{vis}>+<u_rf_{adv}>)" ON <domainfaces> # other information: region = <domainfaces>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/u_f.arb ../../../development/current/templates/navier_stokes/u_f.arb ../../../development/current/templates/navier_stokes/u_f.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/u_f.arb /Users/daltonh/codes/arb/development/current/templates/navier_stokes/u_f.arb /Users/daltonh/codes/arb/development/current/templates/navier_stokes/u_f.arb: comments =   
# FACE_DERIVED <u_f> [1] "<u_f_{raw}>+faceif(facedelta(<domainfaces>),<u_f_{correction}>,0.d0)" ON <allfaces> # other information: region = <allfaces>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/u_f.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/u_f.arb: comments = # volume (velocity) transport
# FACE_DERIVED <J_f[l=1]> [1] "( + (<facenorm[l=1]>)*(<tau[l=1,1]>) + (<facenorm[l=2]>)*(<tau[l=2,1]>) + (<facenorm[l=3]>)*(<tau[l=3,1]>) )+<J_advection_f[l=1]>" ON <allfaces> # other information: region = <allfaces>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/momentum_flux.arb ../../../development/current/templates/navier_stokes/momentum_flux.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/momentum_flux.arb /Users/daltonh/codes/arb/development/current/templates/navier_stokes/momentum_flux.arb: comments =  
# FACE_DERIVED <J_f[l=2]> [1] "( + (<facenorm[l=1]>)*(<tau[l=1,2]>) + (<facenorm[l=2]>)*(<tau[l=2,2]>) + (<facenorm[l=3]>)*(<tau[l=3,2]>) )+<J_advection_f[l=2]>" ON <allfaces> # other information: region = <allfaces>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/momentum_flux.arb ../../../development/current/templates/navier_stokes/momentum_flux.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/momentum_flux.arb /Users/daltonh/codes/arb/development/current/templates/navier_stokes/momentum_flux.arb: comments =  
# #--------------------------------------------------------------------------------
# # equation variables:
# CELL_EQUATION <continuity> [1] "celldiv(<u_f>)" ON <domain> # other information: region = <domain>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/conservation.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/conservation.arb: comments = # continuity
# CELL_EQUATION <momentum[l=1]> [1] "celldiv(<J_f[l=1]>)-<dynamic_force_c[l=1]>" ON <domain> # other information: region = <domain>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/conservation.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/conservation.arb: comments = # momentum component
# CELL_EQUATION <momentum[l=2]> [1] "celldiv(<J_f[l=2]>)-<dynamic_force_c[l=2]>" ON <domain> # other information: region = <domain>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/conservation.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/conservation.arb: comments = # momentum component
# FACE_EQUATION <outlet fully developed> [1] "( + (<ugrad_f[l=1,1]>)*(<facenorm[l=1]>*<facenorm[l=1]>) + (<ugrad_f[l=1,2]>)*(<facenorm[l=2]>*<facenorm[l=1]>) + (<ugrad_f[l=1,3]>)*(<facenorm[l=3]>*<facenorm[l=1]>) + (<ugrad_f[l=2,1]>)*(<facenorm[l=1]>*<facenorm[l=2]>) + (<ugrad_f[l=2,2]>)*(<facenorm[l=2]>*<facenorm[l=2]>) + (<ugrad_f[l=2,3]>)*(<facenorm[l=3]>*<facenorm[l=2]>) + (<ugrad_f[l=3,1]>)*(<facenorm[l=1]>*<facenorm[l=3]>) + (<ugrad_f[l=3,2]>)*(<facenorm[l=2]>*<facenorm[l=3]>) + (<ugrad_f[l=3,3]>)*(<facenorm[l=3]>*<facenorm[l=3]>) )" ON <outlet> # other information: region = <outlet>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/u_fully_developed.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/u_fully_developed.arb: comments = # normal velocity component is fully developed
# FACE_EQUATION <outlet no slip1> [1] "( + (<u_f_vect[l=1]>)*(<facetang1[l=1]>) + (<u_f_vect[l=2]>)*(<facetang1[l=2]>) + (<u_f_vect[l=3]>)*(<facetang1[l=3]>) )" ON <outlet> # other information: region = <outlet>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/noslip.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/noslip.arb: comments = # no component tangential to the face
# FACE_EQUATION <outlet flowrate equation> [1] "<p_f>-0.d0" ON <outlet> # other information: region = <outlet>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/inlet_p_set.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/inlet_p_set.arb: comments = # specified pressure
# FACE_EQUATION <walls noflux> [1] "<u_f>" ON <walls> # other information: region = <walls>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/noflux.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/noflux.arb: comments = # no flux normal to region
# FACE_EQUATION <walls noslip1> [1] "( + (<u_f_vect[l=1]>)*(<facetang1[l=1]>) + (<u_f_vect[l=2]>)*(<facetang1[l=2]>) + (<u_f_vect[l=3]>)*(<facetang1[l=3]>) )" ON <walls> # other information: region = <walls>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/noslip.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/noslip.arb: comments = # no component tangential to the face
# FACE_EQUATION <walls p_extrapolation> [1] "<dynamic_force_f>" ON <walls> # other information: region = <walls>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/p_extrapolation.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/p_extrapolation.arb: comments = # pressure gradient next to wall set so that dynamic pressure gradient inext to wall is zero
# FACE_EQUATION <inlet fully developed> [1] "( + (<ugrad_f[l=1,1]>)*(<facenorm[l=1]>*<facenorm[l=1]>) + (<ugrad_f[l=1,2]>)*(<facenorm[l=2]>*<facenorm[l=1]>) + (<ugrad_f[l=1,3]>)*(<facenorm[l=3]>*<facenorm[l=1]>) + (<ugrad_f[l=2,1]>)*(<facenorm[l=1]>*<facenorm[l=2]>) + (<ugrad_f[l=2,2]>)*(<facenorm[l=2]>*<facenorm[l=2]>) + (<ugrad_f[l=2,3]>)*(<facenorm[l=3]>*<facenorm[l=2]>) + (<ugrad_f[l=3,1]>)*(<facenorm[l=1]>*<facenorm[l=3]>) + (<ugrad_f[l=3,2]>)*(<facenorm[l=2]>*<facenorm[l=3]>) + (<ugrad_f[l=3,3]>)*(<facenorm[l=3]>*<facenorm[l=3]>) )" ON <inlet> # other information: region = <inlet>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/u_fully_developed.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/u_fully_developed.arb: comments = # normal velocity component is fully developed
# FACE_EQUATION <inlet no slip1> [1] "( + (<u_f_vect[l=1]>)*(<facetang1[l=1]>) + (<u_f_vect[l=2]>)*(<facetang1[l=2]>) + (<u_f_vect[l=3]>)*(<facetang1[l=3]>) )" ON <inlet> # other information: region = <inlet>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/noslip.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/noslip.arb: comments = # no component tangential to the face
# FACE_EQUATION <inlet flowrate equation> [1] "<u_f>+<u_av>" ON <inlet> # other information: region = <inlet>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/inlet_u_set.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/inlet_u_set.arb: comments = # specified velocity distribution
# #--------------------------------------------------------------------------------
# # output variables:
# #--------------------------------------------------------------------------------
# # condition variables:
# #--------------------------------------------------------------------------------
# # local variables:
# FACE_LOCAL <tau[l=1,1]> [1] "-<mu>*2.d0*<ugrad_f[l=1,1]>" ON <allfaces> # other information: region = <allfaces>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/total_stress.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/total_stress.arb: comments = empty
# FACE_LOCAL <tau[l=2,2]> [1] "-<mu>*2.d0*<ugrad_f[l=2,2]>" ON <allfaces> # other information: region = <allfaces>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/total_stress.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/total_stress.arb: comments = empty
# FACE_LOCAL <tau[l=1,2]> [1] "-<mu>*(<ugrad_f[l=1,2]>+<ugrad_f[l=2,1]>)" ON <allfaces> # other information: region = <allfaces>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/total_stress.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/total_stress.arb: comments = empty
# FACE_LOCAL <tau[l=2,1]> [1] "<tau[l=1,2]>" ON <allfaces> # other information: region = <allfaces>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/total_stress.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/total_stress.arb: comments = empty
# FACE_LOCAL <dynamic_force_f> [1] "-facegrad[dxunit](<p>)" ON <allfaces> # other information: region = <allfaces>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/p_error.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/p_error.arb: comments = # now defined on <allfaces> to allow use as a BC
# FACE_LOCAL <u_f_vect[l=1]> [1] "faceave[](<u[l=1]>)" ON <allfaces> # other information: region = <allfaces>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/u_f.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/u_f.arb: comments = empty
# FACE_LOCAL <u_f_vect[l=2]> [1] "faceave[](<u[l=2]>)" ON <allfaces> # other information: region = <allfaces>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/u_f.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/u_f.arb: comments = empty
# FACE_LOCAL <u_rf_{vis}> [1] "<mu>/<facedx>^2" ON <domainfaces> # other information: region = <domainfaces>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/u_f.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/u_f.arb: comments = empty
# FACE_LOCAL <u_rf_{adv}> [1] "2.d0*<rho>*abs(<u_f_{raw}>)/<facedx>" ON <domainfaces> # other information: region = <domainfaces>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/u_f.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/u_f.arb: comments = empty
# FACE_LOCAL <J_advection_f[l=1]> [1] "<rho>*faceave[advection,](<u[l=1]>,<u_f>,<adv_limiter>)*<u_f>" ON <allfaces> # other information: region = <allfaces>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/advection_flux.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/advection_flux.arb: comments = empty
# FACE_LOCAL <J_advection_f[l=2]> [1] "<rho>*faceave[advection,](<u[l=2]>,<u_f>,<adv_limiter>)*<u_f>" ON <allfaces> # other information: region = <allfaces>: deriv = 1: newtstepmax = empty: newtstepmin = empty: filename = ../../../development/current/templates/navier_stokes/advection_flux.arb: absfilename = /Users/daltonh/codes/arb/development/current/templates/navier_stokes/advection_flux.arb: comments = empty
#
# ELSE
