# flux of momentum over and in the direction of each face

# check default strings are set
INCLUDE "default_string_replacements"

# start by placing in viscous momentum transport, applicable to both the stokes and navier-stokes equations
<<dim1comment>>FACE_DERIVED <J_f[l=1]> "dot(<facenorm[l=:]>,<tau[l=:,1]>)" ON <allfaces>
<<dim2comment>>FACE_DERIVED <J_f[l=2]> "dot(<facenorm[l=:]>,<tau[l=:,2]>)" ON <allfaces>
<<dim3comment>>FACE_DERIVED <J_f[l=3]> "dot(<facenorm[l=:]>,<tau[l=:,3]>)" ON <allfaces>

# and now add advection momentum transport for just the navier-stokes equations using self-referencing
IF {{ return (!(string_eval('<<stokes>>'))) }} # this will be true for non-stokes (=navier-stokes) simulations
  <<dim1comment>>VARIABLE <J_f[l=1]> "<J_f[l=1]>+<J_advection_f[l=1]>"
  <<dim2comment>>VARIABLE <J_f[l=2]> "<J_f[l=2]>+<J_advection_f[l=2]>"
  <<dim3comment>>VARIABLE <J_f[l=3]> "<J_f[l=3]>+<J_advection_f[l=3]>"
END_IF
