# total stress tensor
INCLUDE "u_gradient_tensor"

# no both cartesian and cylindrical stresses don't include pressure
# without the numerical velocity divergence
#<<dim1comment>> FACE_LOCAL <tau[l=1,1]> "-<mu_f>*2.d0*<ugrad_f[l=1,1]>" ON <allfaces>
#<<dim2comment>> FACE_LOCAL <tau[l=2,2]> "-<mu_f>*2.d0*<ugrad_f[l=2,2]>" ON <allfaces>
#<<dim3comment>> FACE_LOCAL <tau[l=3,3]> "-<mu_f>*2.d0*<ugrad_f[l=3,3]>" ON <allfaces>
# with the numerical velocity divergence (although it is generally set to zero in u_gradient_tensor anyway)
# Note: "<udiv_f>/3.d0" is specifically replaced in strain_rate_magnitude template
<<dim1comment>> FACE_LOCAL <tau[l=1,1]> "-<mu_f>*2.d0*(<ugrad_f[l=1,1]>-<udiv_f>/3.d0)" ON <allfaces>
<<dim2comment>> FACE_LOCAL <tau[l=2,2]> "-<mu_f>*2.d0*(<ugrad_f[l=2,2]>-<udiv_f>/3.d0)" ON <allfaces>
<<dim3comment>> FACE_LOCAL <tau[l=3,3]> "-<mu_f>*2.d0*(<ugrad_f[l=3,3]>-<udiv_f>/3.d0)" ON <allfaces>
<<dim1comment>><<dim2comment>>FACE_LOCAL <tau[l=1,2]> "-<mu_f>*(<ugrad_f[l=1,2]>+<ugrad_f[l=2,1]>)" ON <allfaces>
<<dim1comment>><<dim3comment>>FACE_LOCAL <tau[l=1,3]> "-<mu_f>*(<ugrad_f[l=1,3]>+<ugrad_f[l=3,1]>)" ON <allfaces>
<<dim2comment>><<dim3comment>>FACE_LOCAL <tau[l=2,3]> "-<mu_f>*(<ugrad_f[l=2,3]>+<ugrad_f[l=3,2]>)" ON <allfaces>
<<dim2comment>><<dim1comment>>FACE_LOCAL <tau[l=2,1]> "<tau[l=1,2]>" ON <allfaces>
<<dim3comment>><<dim1comment>>FACE_LOCAL <tau[l=3,1]> "<tau[l=1,3]>" ON <allfaces>
<<dim3comment>><<dim2comment>>FACE_LOCAL <tau[l=3,2]> "<tau[l=2,3]>" ON <allfaces>
